---
import Layout from '../../layouts/Layout.astro';
import CTASection from '../../components/shared/CTASection.astro';
import { getSolutionById } from '../../data/solutions';
import { getCaseStudiesBySolutionType } from '../../data/caseStudies';

const solution = getSolutionById('devsecops');
if (!solution) throw new Error('Solution not found');

const caseStudies = getCaseStudiesBySolutionType('devsecops');
---

<Layout
  title={solution.title}
  description={solution.description}
>

  <!-- Hero Section -->
  <section class="section-padding relative overflow-hidden">
    <div class="absolute inset-0 hexagon-pattern opacity-30"></div>
    <div class="absolute inset-0 bg-gradient-radial from-deep-space/50 to-transparent"></div>

    <div class="container-custom relative z-10">
      <div class="max-w-4xl mx-auto text-center reveal">
        <div class="inline-flex items-center justify-center w-20 h-20 rounded-2xl bg-gradient-hero mb-6 text-white">
          <div set:html={solution.icon} />
        </div>

        <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold mb-6">
          <span class="text-gradient">{solution.heroHeadline}</span>
        </h1>

        <p class="text-xl md:text-2xl text-steel mb-8">
          {solution.heroSubheadline}
        </p>

        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <a href="/contact" class="btn-primary">
            <span>Book Security Assessment</span>
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
          <a href="#services" class="btn-secondary">
            See What You Get
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- The Problem -->
  <section class="section-padding relative">
    <div class="container-custom">
      <div class="max-w-5xl mx-auto">
        <div class="card-glass p-8 md:p-12 reveal">
          <div class="glow-effect"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-3 mb-6">
              <svg class="w-8 h-8 text-electric" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
              </svg>
              <h2 class="text-3xl md:text-4xl font-bold text-white">The Problem</h2>
            </div>

            <p class="text-xl text-steel mb-6 leading-relaxed">
              {solution.problemStatement}
            </p>

            <ul class="space-y-4">
              {solution.problems.map(problem => (
                <li class="flex items-start gap-3">
                  <svg class="w-6 h-6 text-red-400 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                  <span class="text-steel text-lg leading-relaxed">{problem}</span>
                </li>
              ))}
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Our Solution -->
  <section class="section-padding relative">
    <div class="container-custom">
      <div class="max-w-5xl mx-auto">
        <div class="text-center mb-12 reveal">
          <h2 class="text-4xl md:text-5xl font-bold mb-4">
            <span class="text-white">Our</span>
            <span class="text-gradient"> Solution</span>
          </h2>
        </div>

        <div class="space-y-6 reveal">
          {solution.solutionOverview.map(paragraph => (
            <p class="text-lg text-steel leading-relaxed">
              {paragraph}
            </p>
          ))}
        </div>

        <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-4 reveal">
          {solution.benefits.map(benefit => (
            <div class="flex items-start gap-3 p-4 bg-white/5 rounded-lg border border-white/10">
              <svg class="w-5 h-5 text-cyan flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
              </svg>
              <span class="text-white font-medium">{benefit}</span>
            </div>
          ))}
        </div>
      </div>
    </div>
  </section>

  <!-- What You Get -->
  <section id="services" class="section-padding relative">
    <div class="absolute inset-0 hexagon-pattern opacity-20"></div>

    <div class="container-custom relative">
      <div class="text-center mb-12 reveal">
        <h2 class="text-4xl md:text-5xl font-bold mb-4">
          <span class="text-white">What You</span>
          <span class="text-gradient"> Get</span>
        </h2>
        <p class="text-xl text-steel max-w-3xl mx-auto">
          Complete DevSecOps and supply chain security services—from SBOM generation to runtime protection.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {solution.services.map((service, index) => (
          <div
            class="card-glass p-6 reveal"
            style={`transition-delay: ${index * 50}ms`}
          >
            <div class="glow-effect"></div>
            <div class="relative z-10">
              <h3 class="text-xl font-bold text-white mb-3">{service.title}</h3>
              <p class="text-steel leading-relaxed">{service.description}</p>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- AI Penetration Testing Integration -->
  <section class="section-padding relative overflow-hidden">
    <div class="absolute inset-0 bg-gradient-radial from-electric/5 via-transparent to-transparent"></div>

    <div class="container-custom relative">
      <div class="max-w-5xl mx-auto">
        <div class="card-glass p-8 md:p-12 reveal">
          <div class="glow-effect"></div>
          <div class="relative z-10">
            <div class="flex items-start gap-4 mb-6">
              <svg class="w-10 h-10 text-electric flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
              </svg>
              <div>
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
                  AI Penetration Testing as a <span class="text-gradient">Security Gate</span>
                </h2>
                <p class="text-xl text-steel">
                  Autonomous adversarial testing integrated directly into your CI/CD pipeline—catching vulnerabilities before they reach production.
                </p>
              </div>
            </div>

            <div class="space-y-6 mb-8">
              <p class="text-steel text-lg leading-relaxed">
                Traditional vulnerability scanning flags known CVEs. AI penetration testing goes further—it thinks like an attacker, chains vulnerabilities together, and tests exploitability in context.
              </p>
              <p class="text-steel text-lg leading-relaxed">
                Our AI pentest agents run automatically on every deployment, performing reconnaissance, vulnerability analysis, and attack vector validation against your staging environment. This isn't static analysis—it's autonomous adversarial testing with explainable AI reasoning.
              </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
              <div class="bg-white/5 rounded-lg p-6 border border-white/10">
                <h4 class="text-white font-bold mb-3 flex items-center gap-2">
                  <svg class="w-5 h-5 text-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  How It Works
                </h4>
                <ul class="space-y-2 text-steel text-sm">
                  <li>• Runs as a CI/CD pipeline stage after build/test</li>
                  <li>• AI agent performs automated recon on staging environment</li>
                  <li>• Identifies attack surface and proposes attack vectors</li>
                  <li>• Human approval gate before exploitation attempts</li>
                  <li>• Generates detailed security report with remediation steps</li>
                  <li>• Blocks deployment if critical vulnerabilities found</li>
                </ul>
              </div>

              <div class="bg-white/5 rounded-lg p-6 border border-white/10">
                <h4 class="text-white font-bold mb-3 flex items-center gap-2">
                  <svg class="w-5 h-5 text-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                  </svg>
                  What It Catches
                </h4>
                <ul class="space-y-2 text-steel text-sm">
                  <li>• Authentication bypasses and weak credentials</li>
                  <li>• API injection vulnerabilities (SQL, NoSQL, command)</li>
                  <li>• Broken access control and privilege escalation paths</li>
                  <li>• Misconfigured security headers and CORS policies</li>
                  <li>• Exposed secrets and sensitive data leaks</li>
                  <li>• Container escape vectors and lateral movement paths</li>
                </ul>
              </div>
            </div>

            <div class="bg-gradient-to-r from-electric/10 to-cyan/10 rounded-lg p-6 border border-electric/30">
              <h4 class="text-white font-bold mb-3">Integration with Supply Chain Security</h4>
              <p class="text-steel mb-4">
                AI penetration testing complements traditional DevSecOps controls by validating security in production-like environments:
              </p>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="flex items-start gap-2">
                  <span class="text-cyan font-bold">→</span>
                  <span class="text-steel text-sm">SBOM generation identifies dependencies, AI pentest validates they're not exploitable</span>
                </div>
                <div class="flex items-start gap-2">
                  <span class="text-cyan font-bold">→</span>
                  <span class="text-steel text-sm">Vulnerability scanning flags CVEs, AI pentest confirms exploitability and impact</span>
                </div>
                <div class="flex items-start gap-2">
                  <span class="text-cyan font-bold">→</span>
                  <span class="text-steel text-sm">Image signing ensures provenance, AI pentest tests runtime security posture</span>
                </div>
                <div class="flex items-start gap-2">
                  <span class="text-cyan font-bold">→</span>
                  <span class="text-steel text-sm">Policy enforcement blocks bad configs, AI pentest finds logic flaws and attack chains</span>
                </div>
              </div>
            </div>

            <div class="mt-8 flex flex-col sm:flex-row gap-4">
              <a href="/solutions/ai-ops#services" class="btn-secondary inline-flex items-center justify-center">
                <span>Learn More About AI Ops</span>
                <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                </svg>
              </a>
              <a href="/contact" class="btn-primary inline-flex items-center justify-center">
                <span>Discuss Implementation</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Technology Stack -->
  <section class="section-padding relative">
    <div class="container-custom">
      <div class="text-center mb-12 reveal">
        <h2 class="text-4xl md:text-5xl font-bold mb-4">
          <span class="text-white">Technology</span>
          <span class="text-gradient"> Stack</span>
        </h2>
        <p class="text-xl text-steel max-w-3xl mx-auto">
          Best-in-class security tools for supply chain hardening and runtime protection.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {solution.techStack.map((category, index) => (
          <div
            class="card-glass p-8 reveal"
            style={`transition-delay: ${index * 100}ms`}
          >
            <div class="glow-effect"></div>
            <div class="relative z-10">
              <h3 class="text-2xl font-bold text-white mb-6">{category.category}</h3>
              <div class="space-y-4">
                {category.tools.map(tool => (
                  <div class="border-l-2 border-cyan/30 pl-4 hover:border-cyan transition-colors">
                    <h4 class="text-white font-semibold mb-1">{tool.name}</h4>
                    <p class="text-steel text-sm">{tool.description}</p>
                  </div>
                ))}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Case Studies -->
  {caseStudies.length > 0 && (
    <section class="section-padding relative overflow-hidden">
      <div class="absolute inset-0 hexagon-pattern opacity-20"></div>
      <div class="absolute inset-0 bg-gradient-radial from-purple/5 via-transparent to-transparent"></div>

      <div class="container-custom relative">
        <div class="text-center mb-12 reveal">
          <h2 class="text-4xl md:text-5xl font-bold mb-4">
            <span class="text-white">Real</span>
            <span class="text-gradient"> Results</span>
          </h2>
          <p class="text-xl text-steel max-w-3xl mx-auto">
            See how we've delivered DevSecOps and supply chain security for companies like yours.
          </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          {caseStudies.slice(0, 2).map((study, index) => (
            <div
              class="card-glass p-8 reveal"
              style={`transition-delay: ${index * 100}ms`}
            >
              <div class="glow-effect"></div>
              <div class="relative z-10">
                <div class="inline-block px-3 py-1 bg-cyan/10 border border-cyan/30 rounded-full text-cyan text-xs font-semibold uppercase tracking-wider mb-4">
                  {study.clientType}
                </div>
                <h3 class="text-2xl font-bold text-white mb-4">{study.title}</h3>

                <p class="text-steel mb-6 leading-relaxed">
                  {study.problem}
                </p>

                <div class="mb-6">
                  <h4 class="text-green-400 font-semibold mb-3 flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                    </svg>
                    Results
                  </h4>
                  <ul class="space-y-2">
                    {study.outcome.slice(0, 3).map(result => (
                      <li class="flex items-start gap-2 text-white text-sm">
                        <svg class="w-4 h-4 text-green-400 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                        </svg>
                        <span>{result}</span>
                      </li>
                    ))}
                  </ul>
                </div>

                <div class="flex flex-wrap gap-2">
                  {study.technologies.slice(0, 5).map(tech => (
                    <span class="px-2 py-1 bg-white/5 border border-white/10 rounded text-steel text-xs font-mono">
                      {tech}
                    </span>
                  ))}
                </div>
              </div>
            </div>
          ))}
        </div>

        <div class="text-center mt-12 reveal">
          <a href="/case-studies" class="btn-secondary inline-flex">
            View All Case Studies
          </a>
        </div>
      </div>
    </section>
  )}

  <!-- CTA -->
  <CTASection
    headline="Ready to secure your supply chain?"
    subheadline="Book a free security assessment. We'll review your pipelines and show you how to achieve compliance-ready security."
    primaryCTA={{
      text: 'Book Security Assessment',
      href: '/contact'
    }}
    secondaryCTA={{
      text: 'Explore Other Solutions',
      href: '/solutions'
    }}
  />
</Layout>
